**Purpose & Considerations** 


**1.	Purpose** 
This document lists out the approved Splunk Data Model fields which is required for making logs Compliance per Common Information model (CIM) as well as Infrastructure/Cloud Security Content Development.

**2. Field Type & their Definition**
<span style="color:green;font-weight:bold">Mandatory Field </span> : Fields which have direct or indirect impact on existing or in-pipeline InfraSec or CloudSec contents. Lack of these fields will lead to data non-compliance. We will put forward our best efforts to extract or normalize these fields. Respective BISO’s approval will be required if any of these fields are missing.


 <span style="color:orange;font-weight:bold"> Optional Field </span>: Fields which have NO direct or indirect impact on existing or in-pipeline InfraSec or CloudSec contents. We recommend extracting or normalizing these fields if it’s easily available. No BISO’s approval will be required if any of these fields are missing.

**3. Key Points - CIM Normalization**
- Please DO NOT use “unknown”, “NULL”, etc. while extraction for the fields which have not 100% coverage. It MUST be just empty.
- All the mandatory fields which have <100% coverage, MUST be documented with the justification.
- Eventtypes and Tags MUST be built carefully as these two are vital components for datamodel.
- Splunk_SA_CIM MUST be appended with required index(es) as appropriate.

**4.	Malware**
The fields and tags in the Malware data model 


| Priority | **Field** | **Data Type** | **Description** | **Expectation** | **Example** | 
|--|--|--|--|--|--|
|<span style="color:green;font-weight:bold">Mandatory Field </span>|action	|string	|The action taken by the reporting device.|Must be in lower case. Prescribed values: allowed, blocked, deferred | 	blocked	|
|<span style="color:green;font-weight:bold">Mandatory Field </span> | Category | string | The category of the malware event, such as keylogger or ad-supported program. Note: This is a string value. Use a category_id field for category ID fields that are integer data types (category_id fields are optional, so they are not included in this table).|Customized category of the malware event which could be be tool/application specific.|Keylogger |
|<span style="color:green;font-weight:bold">Mandatory Field </span>|date | string | The date of the malware event.|Date Must be in **MM-DD-YYYY** format.|09-22-2021|
|<span style="color:green;font-weight:bold">Mandatory Field </span>| dest|string |The system that was affected by the malware event. You can alias this from more specific fields, such as dest_host, dest_ip, or dest_name. | Must be either IP address or endpoint names.dest host and name can optionally be captured under “dest_host” and “dest_name” fields respectively.|
|<span style="color:orange;font-weight:bold"> Optional Field </span> |dest_nt_domain | string |The NT domain of the destination, if applicable |OPTIONAL|
|<span style="color:green;font-weight:bold">Mandatory Field </span> | file_hash|string | The hash of the file with suspected malware.|SHA256 File hash value or equivalent. Tip: “FileHash” could be one field where we should look. Not applicable for all the cases.|17E771B9DA1EAD7F3F92DC8BA48C064D41DD790D69D7D98B44 |
|<span style="color:green;font-weight:bold">Mandatory Field </span> |file_name | string| The name of the file with suspected malware. |Must be in lower case. |testfile.pdf |
|<span style="color:green;font-weight:bold">Mandatory Field </span> |file_path | string | The full file path of the file with suspected malware.| Must be in lower case. | c:\testfolder |
|<span style="color:green;font-weight:bold">Mandatory Field </span> |severity| string |The severity of the network protection event. Note: This field is a string. Use severity_id for severity ID fields that are integer data types. Also, specific values are required for this field. Use vendor_severity for the vendor's own human readable severity strings, such as Good, Bad, and Really Bad. |Prescribed Values: critical, high, medium, low, informational | high |
|<span style="color:orange;font-weight:bold"> Optional Field </span> | severity_id | string | The numeric or vendor specific severity indicator corresponding to the event severity. | OPTIONAL |
|<span style="color:green;font-weight:bold">Mandatory Field </span> | Signature | string |The name of the malware infection detected on the client (the dest). <br/> <br/>Note: This is a string value. Use a signature_id field for signature ID fields that are integer data types. | It could be tool/application specific malware infection names. <br/> <br/> **Examples:**<br/> 1. Per Cylance: Dual Use - Remote Access Dual Use - ToolMalicious Payload Malware – Generic Malware – Infostealer Malware - TrojanOverwrite <br/> <br/> 2. Per Mcafee: Artemis!2DF3190BD958Autoprotection : protéger les processus McAfee  Browsers launching files from the Downloaded Program Files folder Core Protection - Protect core McAfee files <br/><br/> 3. Per Splunk documentation Trojan.Vundo, Spyware.Gaobot, W32.Nimbda | Browsers launching files from the Downloaded Program Files folder |
|<span style="color:green;font-weight:bold">Mandatory Field </span> |signature_id|string |The unique identifier or event code of the event signature. | Must be 1:1 mapped with signature field above. Could be numeric, alphanumeric, as well as string values. | 1095|
|<span style="color:green;font-weight:bold">Mandatory Field </span> | src |string | The source of the event, such as a DAT file relay server. You can alias this from more specific fields, such as src_host, src_ip, or src_name. | Must be IP address or endpoint name. <br/> Source host and name can optionally be captured under “src_host” and “src_name” fields respectively. <br/><br/> **Note:** “x-forwarded-for” feature must be enabled on the F5 side if source is coming via F5 or equivalent tool. |
|<span style="color:green;font-weight:bold">Mandatory Field </span> | src_user |string | The reported sender of an email-based attack. | **Mandatory** for email based event or attack only. <br/>Sender email address (xyz@abc.com) would be the value. Else, **Optional**.|
| <span style="color:green;font-weight:bold">Mandatory Field </span>| tag | string | This automatically generated field is used to access tags from within datamodels. Do not define extractions for this field when writing add-ons. | Must be “malware” and “attack”. “operations” tag is optional.|
| <span style="color:green;font-weight:bold">Mandatory Field </span> | user | string | The user involved in the malware event. | username without domain. Must be in lower case. <br/> <br/> Example: xyz<span style="color:red;"><del>@abc.com</del></span> <br/><br/> **[Note, username should be able to traced when it comes to incident investigation]** <br/><br/> **“Src” values can be used for identifying the internal vs external looking at the IP CIDR ranges.** |
| <span style="color:orange;font-weight:bold"> Optional Field </span> | url | string | A URL containing more information about the vulnerability. | Must be in standard URL format. <br/> **Optional** |
| <span style="color:green;font-weight:bold">Mandatory Field </span> | vendor_product | string | The vendor and product name of the endpoint protection system, such as Symantec AntiVirus. This field can be automatically populated by vendor and product fields in your data. | Vendor product name in camel case. <br/>Example: JAMF Protect. Cylance, McAfee EPO |
| <span style="color:orange;font-weight:bold"> Optional Field </span> | dest | string | The system where the malware operations event occurred. | **OPTIONAL** <br/>It comes under “operations” dataset.|
| <span style="color:orange;font-weight:bold"> Optional Field </span> | dest_nt_domain | string | The NT domain of the dest system, if applicable.| **OPTIONAL** <br/>It comes under “operations” dataset.|
| <span style="color:orange;font-weight:bold"> Optional Field </span> | product_vendor | string | The product version of the malware operations product. | **OPTIONAL** <br/>It comes under “operations” dataset.|
| <span style="color:orange;font-weight:bold"> Optional Field </span> | signature_version | string | The version of the malware signature bundle in a signature update operations event. | **OPTIONAL** <br/>It comes under “operations” dataset.|
| <span style="color:orange;font-weight:bold"> Optional Field </span> | tag | string | The tag associated with the malware operations event. | **OPTIONAL** <br/>It comes under “operations” dataset.
| <span style="color:orange;font-weight:bold"> <span style="color:orange;font-weight:bold"> Optional Field </span> </span> | vendor_product | string | The vendor product name of the malware operations product. | **OPTIONAL** <br/>It comes under “operations” dataset.|
<span style="color:green;font-weight:bold">Mandatory Field </span>|work_country | string |Country from where the logs are originating. |Must be in Upper Case. |Example: work_country of the Netskope logs from US in the index= amer_cloud_netskope_casb  would be work_country=US|